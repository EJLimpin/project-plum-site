{"filter":false,"title":"changepassword.php","tooltip":"/changepassword.php","undoManager":{"mark":14,"position":14,"stack":[[{"start":{"row":0,"column":0},"end":{"row":77,"column":2},"action":"insert","lines":["<?php","// Core Initialization","require_once 'core/init.php';","// Header","include 'includes/header.php';","echo \"<div class='maincontainer'>\";","$user = new User();","if (!$user->isLoggedIn()) {","  Redirect::to('index.php');","}","if (Input::exists()) {","  if (Token::check(Input::get('token'))) {","    //echo \"Ok!\";","    $validate = new Validate();","    $validation = $validate->check($_POST, array(","      'password_current' => array(","        'required' => true,","        'min' => 6","      ),","      'password_new' => array(","        'required' => true,","        'min' => 6","      ),","      'password_new_again' => array(","        'required' => true,","        'min' => 6,","        'matches' => 'password_new'","      )","    ));","    if($validation->passed()) {","      if (Hash::make(Input::get('password_current'), $user->data()->salt) !== $user->data()->password) {","        echo 'Your current password is wrong.';","      } else {","        // password user change","        // echo 'Ok!';","        $salt = Hash::salt(32);","        $user->update(array(","          'password' => Hash::make(Input::get('password_new'), $salt),","          'salt' => $salt","        ));","        Session::flash('home', 'Your password has been changed.');","        Redirect::to('index.php');","      }","    } else {","      foreach($validation->errors() as $error) {","        echo $error, '<br>';","    }","  }","}","}","?>","","","","<form class=\"\" action=\"\" method=\"post\">","  <div class=\"field form-group\">","    <label for=\"password_current\">Current password</label>","    <input type=\"password\" class=\"form-control\" name=\"password_current\" value=\"\" id=\"password_current\" autocomplete=\"off\">","  </div>","","  <div class=\"field form-group\">","    <label for=\"password_new\">New password</label>","    <input type=\"password\" class=\"form-control\" name=\"password_new\" value=\"\" id=\"password_new\" autocomplete=\"off\">","  </div>","","  <div class=\"field form-group\">","    <label for=\"password_new_again\">New password again</label>","    <input type=\"password\" class=\"form-control\" name=\"password_new_again\" value=\"\" id=\"password_new_again\" autocomplete=\"off\">","  </div>","  <input type=\"hidden\" name=\"token\" value=\"<?php echo Token::generate(); ?>\">","  <input type=\"submit\" value=\"Change\">","","</form>","","<?php","  echo \"</div> <!-- //maincontainer -->\";","  include 'includes/footer.php';","?>"],"id":1}],[{"start":{"row":1,"column":0},"end":{"row":1,"column":22},"action":"remove","lines":["// Core Initialization"],"id":2}],[{"start":{"row":12,"column":3},"end":{"row":12,"column":17},"action":"remove","lines":[" //echo \"Ok!\";"],"id":3}],[{"start":{"row":12,"column":2},"end":{"row":12,"column":3},"action":"remove","lines":[" "],"id":4}],[{"start":{"row":12,"column":1},"end":{"row":12,"column":2},"action":"remove","lines":[" "],"id":5}],[{"start":{"row":12,"column":0},"end":{"row":12,"column":1},"action":"remove","lines":[" "],"id":6}],[{"start":{"row":11,"column":42},"end":{"row":12,"column":0},"action":"remove","lines":["",""],"id":7}],[{"start":{"row":32,"column":7},"end":{"row":33,"column":22},"action":"remove","lines":[" // password user change","        // echo 'Ok!';"],"id":8}],[{"start":{"row":32,"column":6},"end":{"row":32,"column":7},"action":"remove","lines":[" "],"id":9}],[{"start":{"row":32,"column":5},"end":{"row":32,"column":6},"action":"remove","lines":[" "],"id":10}],[{"start":{"row":32,"column":4},"end":{"row":32,"column":5},"action":"remove","lines":[" "],"id":11}],[{"start":{"row":32,"column":0},"end":{"row":32,"column":4},"action":"remove","lines":["    "],"id":12}],[{"start":{"row":31,"column":14},"end":{"row":32,"column":0},"action":"remove","lines":["",""],"id":13}],[{"start":{"row":3,"column":0},"end":{"row":4,"column":30},"action":"remove","lines":["// Header","include 'includes/header.php';"],"id":14}],[{"start":{"row":72,"column":0},"end":{"row":72,"column":32},"action":"remove","lines":["  include 'includes/footer.php';"],"id":15}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":17,"column":30},"end":{"row":17,"column":30},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":24,"state":"php-start","mode":"ace/mode/php"}},"timestamp":1511290098496,"hash":"5e292b81ced42380fb41a50b1b6533cb12f053fd"}